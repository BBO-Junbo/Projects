<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <!-- 其他头部内容 -->
    <title>遛狗预约系统（主人端）</title>
    <style>
        /* 设置页面样式 */
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-image: url("../../images/主人端.jpg");
            background-size: cover;
            background-position: center;
        }
        .container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        header, footer {
            color: #fff;
            padding: 10px;
        }
        main {
            flex-grow: 1;
            display: flex;
        }
        section{
            flex-grow: 1;
            background-color:transparent;
            background-color: white;
            opacity: 0.75;
            padding-left: 20px;
        }
        aside {
            background-color: #f1f1f1;
            padding: 10px;
        }
        nav {
            display: flex;
            flex-direction: column;
        }
        nav button {
            margin-bottom: 5px;
            padding: 10px;
            background-color: #eee;
            border: none;
            cursor: pointer;
        }
        nav button:hover {
            background-color: #ccc;
        }
        .btn {
            display: inline-block;
            padding: 10px 20px;
            background-color: #eee;
            border: none;
            text-decoration: none;
            color: #666;
            font-weight: bold;
            cursor: pointer;
        }
        .btn-large {
            font-size: 24px; /* 设置大号按钮字体大小 */
            background-image: url("../../images/图标.jpg");
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
        }
        .form-group input {
            padding: 10px;
            width: 300px;
        }
    </style>
</head>
<body>
<div class="container">
    <header>
        <!-- 页面顶部 -->
        <h1>遛狗预约系统（主人端）</h1>
    </header>
    <main>
        <!-- 页面中部 -->
        <aside>
            <!-- 左侧导航栏 -->
            <nav>
                <button class="btn btn-large">
                    <a href="../../../../../../target/classes/static/web/masterweb/masterindex.html" class="btn">主人首页</a>
                </button>
                <button class="btn btn-large">
                    <a href="../../../../../../target/classes/static/web/masterweb/masterdata.html" class="btn">修改个人信息</a>
                </button>
                <button class="btn btn-large">
                    <a href="../../../../../../target/classes/static/web/masterweb/masterpassword.html" class="btn">修改密码</a>
                </button>
                <button class="btn btn-large">
                    <a href="../../../../../../target/classes/static/web/masterweb/mydogs.html" class="btn">我的狗狗</a>
                </button>
                <button class="btn btn-large">
                    <a href="../../../../../../target/classes/static/web/masterweb/rateWalker.html" class="btn">评价遛狗人</a>
                </button>
                <button class="btn btn-large">
                    <a href="../../../../../../target/classes/static/web/masterweb/dogavailability.html" class="btn">修改可遛时间</a>
                </button>
            </nav>
        </aside>
        <section>
            <!-- 中部内容 -->
            <h2>修改狗狗信息</h2>
            <form id="form-update-new-dog" enctype="multipart/form-data" method="post" action="/dogs/add_new_dog">
                <div class="form-group">
                    <label for="dog-name">名字:</label>
                    <input name="dogName" type="text" id="dog-name" placeholder="Dog's name">
                </div>
                <div class="form-group">
                    <label for="dog-breed">品种:</label>
                    <input name="dogBreed" type="text" id="dog-breed" placeholder="Dog's breed">
                </div>
                <div class="form-group">
                    <label for="dog-age">年龄:</label>
                    <input name="dogAge" type="number" id="dog-age" placeholder="Dog's age">
                </div>
                <div class="form-group">
                    <label for="dog-address">地址:</label>
                    <input name="address" type="text" id="dog-address" placeholder="Dog's address">
                </div>
                <div class="form-group">
                    <label for="dog-gender">性别：</label>
                    <select name="dogGender" id="dog-gender" style="width: 200px;">
                        <option value="M">牡</option>
                        <option value="F">牝</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="is-neutered">是否绝育:</label>
                    <select name="isNeutered" id="is-neutered" style="width: 200px;">
                        <option value="否">否</option>
                        <option value="是">是</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="is-sick">是否生病:</label>
                    <select name="isSick" id="is-sick" style="width: 200px;">
                        <option value="否">否</option>
                        <option value="是">是</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="dog-remark">主人简介:</label>
                    <input name="remark" type="text" id="dog-remark" placeholder="Remark about the dog">
                </div>

                <button id="btn-update-new-dog" type="button" class="btn" style="margin-top: 10px;">修改</button>
            </form>
        </section>
    </main>
    <footer>
        <!-- 页面底部 -->
        <p>&copy; 版权所有 2023. All rights reserved.</p>
    </footer>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
// 获取查询字符串
const urlParams = new URLSearchParams(window.location.search);

// 获取 dogId 参数的值
const dogId = Number(urlParams.get("dogId"));
console.log(dogId); // 输出传递的 dogId 参数值

// 获取按钮元素
const btnUpdateDog = document.getElementById("btn-update-new-dog");

// 设置点击事件处理函数
btnUpdateDog.addEventListener("click", function() {
  updateDog(dogId);
});

function updateDog(dogId) {
  // 获取更新信息，可以通过表单或其他方式获取需要更新的狗狗属性
  const updatedDog = {
    dogName: document.getElementById("dog-name").value,
    dogBreed: document.getElementById("dog-breed").value,
    dogAge: document.getElementById("dog-age").value,
    address: document.getElementById("dog-address").value,
    dogGender: document.getElementById("dog-gender").value,
    isNeutered: document.getElementById("is-neutered").value,
    isSick: document.getElementById("is-sick").value,
    remark: document.getElementById("dog-remark").value
  };

  // 发送 Ajax 请求
  $.ajax({
    url: "/dogs/" + dogId + "/update",
    type: "POST",
    dataType: "json",
    data: JSON.stringify(updatedDog), // 转换为 JSON 格式字符串
    contentType: "application/json", // 指定请求的内容类型为 JSON
    success: function(response) {
      if (response.state == 200 || response.state == "success") {
        alert("更新狗狗信息成功");
        window.location.href = "/web/masterweb/mydogs.html";
      } else {
        alert("更新狗狗信息失败");
      }
    },
    error: function() {
      alert("更新狗狗信息时出现错误");
    }
  });
}
</script>

</body>
</html>
