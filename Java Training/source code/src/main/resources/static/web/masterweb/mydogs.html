<!DOCTYPE html>
<html>
<head>

    <meta charset="UTF-8">
    <!-- 其他头部内容 -->


    <title>遛狗预约系统（主人端）</title>
    <style>
        /* 设置页面样式 */
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background-image: url("../../images/主人端.jpg");
            background-size: cover;
            background-position: center;
        }
        .container {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }
        header, footer {
            color: #fff;
            padding: 10px;
        }
        main {
            flex-grow: 1;
            display: flex;
        }
        section{
            flex-grow: 1;
            background-color:transparent;
            background-color: white;
            opacity: 0.75;
            padding-left: 20px;
        }
        aside {
            background-color: #f1f1f1;
            padding: 10px;
        }
        nav {
            display: flex;
            flex-direction: column;
        }
        nav button {
            margin-bottom: 5px;
            padding: 10px;
            background-color: #eee;
            border: none;
            cursor: pointer;
        }
        nav button:hover {
            background-color: #ccc;
        }
        .btn {
            display: inline-block;
            padding: 10px 20px;
            border: none;
            text-decoration: none;
            color: #666;
            font-weight: bold;
            cursor: pointer;
            background-size: cover;
        }
        .btn-large {
            font-size: 24px; /* 设置大号按钮字体大小 */
            background-image: url("../../images/图标.jpg");
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
        }

        .form-group input {
            padding: 10px;
            width: 300px;
        }
        table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
    }

    th, td {
        padding: 10px;
        text-align: center;
        border: 1px solid #ccc;
    }

    th {
        background-color: #f1f1f1;
        font-weight: bold;
    }

    img {
        width: 50px;
        height: 50px;
        object-fit: cover;
        border-radius: 50%;
    }
    </style>

</head>
<body>
<div class="container">
    <header>
        <!-- 页面顶部 -->
        <h1>遛狗预约系统（主人端）</h1>
    </header>
    <main>
        <!-- 页面中部 -->
        <aside>
            <!-- 左侧导航栏 -->
            <nav>
                <button class="btn btn-large">
                    <a href="masterindex.html" class="btn">主人首页</a>
                </button >
                <button class="btn btn-large">
                    <a href="masterdata.html" class="btn">修改个人信息</a>
                </button >
                <button class="btn btn-large">
                    <a href="masterpassword.html" class="btn">修改密码</a>
                </button >
                <button class="btn btn-large">
                    <a href="adddog.html" class="btn">添加狗狗</a>
                </button>
                <button class="btn btn-large">
                    <a href="rateWalker.html" class="btn">评价遛狗人</a>
                </button>
            </nav>
        </aside>
        <section>
            <!-- 中部内容 -->
            <h2>狗狗列表</h2>
            <table>
                <thead>
                <tr>
                    <th>头像</th>
                    <th>名字</th>
                    <th>品种</th>
                    <th>年龄</th>
                    <th>性别</th>
                    <th>是否绝育</th>
                    <th>是否生病</th>
                    <th>主人描述</th>
                    <th>主人姓名</th>
                    <th>地址</th>
                    <th>设置</th>
                    <th>删除</th>
                    <th>修改</th>
                </tr>
                </thead>
                <tbody id="dog-list">
                <tr>
                    <td><img src="dog1.jpg" alt="Dog Avatar"></td>
                    <td>柯基</td>
                    <td>3</td>
                    <td>公</td>
                    <td>是</td>
                    <td>张三</td>
                    <td>北京市</td>

                </tr>
                <tr>
                    <td><img src="dog2.jpg" alt="Dog Avatar"></td>
                    <td>哈士奇</td>
                    <td>2</td>
                    <td>母</td>
                    <td>否</td>
                    <td>李四</td>
                    <td>上海市</td>

                </tr>
                <!-- 添加更多狗狗的信息行 -->
                </tbody>
            </table>
        </section>

    </main>
    <footer>
        <!-- 页面底部 -->
        <p>&copy; 版权所有 2023. All rights reserved.</p>
    </footer>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script type="text/javascript">
$(function() {
    showDogList();
});

function showDogList() {
    $("#dog-list").empty();
    $.ajax({
        url: "/dogs",
        type: "GET",
        dataType: "json",
        success: function(response) {
            if (response.state == 200) {
                var list = response.data;
                for (var i = 0; i < list.length; i++) {
                    let dog = '<tr>'
                        + '<td><img src="#{image}"></td>'
                        + '<td>#{name}</td>'
                        + '<td>#{breed}</td>'
                        + '<td>#{age}</td>'
                        + '<td>#{gender}</td>'
                        + '<td>#{neutered}</td>'
                        + '<td>#{sick}</td>'
                        + '<td>#{remark}</td>'
                        + '<td>#{mastername}</td>'
                        + '<td>#{address}</td>'
                        + '<td><button onclick="setAvailability(#{dogId})">设置可遛时间</button></td>'
                        + '<td><button onclick="confirmDeleteDog(#{dogId})">删除</button></td>'
                        +'<td><button onclick="updateDog(' + list[i].dogId + ')">修改</button></td>'
                        + '</tr>';

                    dog = dog.replace(/#{dogId}/g, list[i].dogId);
                    dog = dog.replace("#{image}", list[i].imageUrl);
                    dog = dog.replace("#{name}", list[i].dogName);
                    dog = dog.replace("#{breed}", list[i].dogBreed);
                    dog = dog.replace("#{age}", list[i].dogAge);
                    dog = dog.replace("#{gender}", list[i].dogGender);
                    dog = dog.replace("#{neutered}", list[i].isNeutered);
                    dog = dog.replace("#{sick}", list[i].isSick);
                    dog = dog.replace("#{remark}", list[i].remark);
                    dog = dog.replace("#{mastername}", list[i].masterName);
                    dog = dog.replace("#{address}", list[i].address);

                    $("#dog-list").append(dog);
                }
                $(".add-def:eq(0)").hide();
            } else {
                alert("获取地址列表失败");
            }
        }
    });
}

function setAvailability(dogId) {
    window.location.href = "dogavailability.html?dogId=" + dogId;
}

function confirmDeleteDog(dogId) {
    var confirmDelete = confirm("确定要删除狗狗吗？");
    if (confirmDelete) {
        deleteDog(dogId);
    }
}
function updateDog(dogId) {
        var url = "http://localhost:8080/web/masterweb/updatedog.html?dogId=" + encodeURIComponent(dogId);
        window.location.href = url;
    }

function deleteDog(dogId) {
    $.ajax({
        url: "/dogs/" + dogId + "/delete",
        type: "POST",
        dataType: "json",
        success: function(response) {
            if (response.state == 200) {
                showDogList();
                alert("删除狗狗成功");
            } else {
                alert("删除狗狗失败");
            }
        },
        error: function() {
            alert("删除狗狗时出现错误");
        }
    });
}
</script>
</body>
</html>